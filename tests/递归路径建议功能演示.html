<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€’å½’JSONè·¯å¾„å»ºè®®åŠŸèƒ½æ¼”ç¤º</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 15px;
        }
        
        .demo-section {
            margin: 30px 0;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
        }
        
        .demo-section h2 {
            color: #34495e;
            margin-top: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .json-input {
            width: 100%;
            height: 200px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            padding: 15px;
            border: 2px solid #bdc3c7;
            border-radius: 5px;
            resize: vertical;
            background-color: #f8f9fa;
        }
        
        .json-input:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);
        }
        
        .controls {
            margin: 15px 0;
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .depth-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .depth-control input {
            width: 60px;
            padding: 5px;
            border: 1px solid #bdc3c7;
            border-radius: 3px;
        }
        
        .suggestions-container {
            max-height: 400px;
            overflow-y: auto;
            border: 2px solid #ecf0f1;
            border-radius: 5px;
            padding: 15px;
            background-color: #fdfdfd;
        }
        
        .suggestion-item {
            padding: 12px;
            margin: 8px 0;
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            border-radius: 0 5px 5px 0;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .suggestion-item:hover {
            background: #e8f4f8;
            border-left-color: #2980b9;
            transform: translateX(5px);
        }
        
        .suggestion-item.selected {
            background: #d5e8ff;
            border-left-color: #0066cc;
        }
        
        .suggestion-label {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .suggestion-path {
            font-family: 'Courier New', monospace;
            color: #8e44ad;
            font-size: 12px;
            background: #f4f1f8;
            padding: 2px 6px;
            border-radius: 3px;
            display: inline-block;
            margin: 2px 0;
        }
        
        .suggestion-description {
            color: #7f8c8d;
            font-size: 13px;
            margin-top: 5px;
        }
        
        .suggestion-meta {
            display: flex;
            gap: 15px;
            margin-top: 8px;
            font-size: 11px;
        }
        
        .depth-badge {
            background: #e74c3c;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
        }
        
        .type-badge {
            padding: 2px 6px;
            border-radius: 3px;
            color: white;
        }
        
        .type-object { background: #9b59b6; }
        .type-array { background: #e67e22; }
        .type-primitive { background: #27ae60; }
        
        .extracted-value {
            background: #2ecc71;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        .error {
            background: #e74c3c;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
        }
        
        .info-box {
            background: #3498db;
            color: white;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
        }
        
        .stats {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            background: #34495e;
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            text-align: center;
            min-width: 100px;
        }
        
        .stat-number {
            font-size: 20px;
            font-weight: bold;
            display: block;
        }
        
        .preset-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .preset-btn {
            background: #95a5a6;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .preset-btn:hover {
            background: #7f8c8d;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”„ é€’å½’JSONè·¯å¾„å»ºè®®åŠŸèƒ½æ¼”ç¤º</h1>
        
        <div class="info-box">
            <strong>åŠŸèƒ½ç‰¹ç‚¹ï¼š</strong>
            <ul>
                <li>ğŸ¯ <strong>æ·±åº¦é€’å½’åˆ†æ</strong>ï¼šæ”¯æŒåˆ†æå¤šå±‚åµŒå¥—çš„JSONç»“æ„</li>
                <li>ğŸ·ï¸ <strong>ç±»å‹å¯è§†åŒ–</strong>ï¼šä½¿ç”¨å›¾æ ‡å’Œé¢œè‰²åŒºåˆ†ä¸åŒæ•°æ®ç±»å‹ï¼ˆğŸ“¦å¯¹è±¡ã€ğŸ”¢æ•°ç»„ã€ğŸ“„åŸºæœ¬ç±»å‹ï¼‰</li>
                <li>ğŸ“Š <strong>ç»“æ„åŒ–å±•ç¤º</strong>ï¼šæŒ‰æ·±åº¦å±‚çº§ç¼©è¿›æ˜¾ç¤ºï¼Œæ¸…æ™°å±•ç°JSONå±‚æ¬¡ç»“æ„</li>
                <li>ğŸ›ï¸ <strong>æ·±åº¦æ§åˆ¶</strong>ï¼šå¯è‡ªå®šä¹‰åˆ†ææ·±åº¦ï¼Œå¹³è¡¡æ€§èƒ½å’Œå®Œæ•´æ€§</li>
                <li>âœ¨ <strong>æ™ºèƒ½å»é‡</strong>ï¼šè‡ªåŠ¨è¯†åˆ«æ•°ç»„ä¸­ç›¸åŒç»“æ„çš„å…ƒç´ ï¼Œé¿å…é‡å¤å»ºè®®</li>
                <li>âš¡ <strong>å®æ—¶æå–</strong>ï¼šç‚¹å‡»å»ºè®®å³å¯å®æ—¶æå–å¯¹åº”è·¯å¾„çš„æ•°æ®</li>
            </ul>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ§ª æµ‹è¯•JSONæ•°æ®</h2>
            <div class="preset-buttons">
                <button class="preset-btn" onclick="loadPreset('complex')">å¤æ‚åµŒå¥—å¯¹è±¡</button>
                <button class="preset-btn" onclick="loadPreset('array')">åµŒå¥—æ•°ç»„ç»“æ„</button>
                <button class="preset-btn" onclick="loadPreset('mixed')">æ··åˆç»“æ„æ•°æ®</button>
                <button class="preset-btn" onclick="loadPreset('ecommerce')">ç”µå•†æ•°æ®ç¤ºä¾‹</button>
            </div>
            
            <textarea id="jsonInput" class="json-input" placeholder="è¯·è¾“å…¥JSONæ•°æ®..."></textarea>
            
            <div class="controls">
                <button class="btn" onclick="analyzeJson()">ğŸ” åˆ†æè·¯å¾„å»ºè®®</button>
                <div class="depth-control">
                    <label>åˆ†ææ·±åº¦ï¼š</label>
                    <input type="number" id="maxDepth" value="4" min="1" max="10">
                    <span>å±‚</span>
                </div>
                <button class="btn" onclick="clearAll()">ğŸ—‘ï¸ æ¸…ç©º</button>
            </div>
            
            <div class="stats" id="stats" style="display: none;"></div>
        </div>
        
        <div class="demo-section">
            <h2>ğŸ’¡ è·¯å¾„å»ºè®®ç»“æœ</h2>
            <div id="suggestionsContainer" class="suggestions-container">
                <p style="color: #7f8c8d; text-align: center; margin: 50px 0;">
                    è¯·è¾“å…¥JSONæ•°æ®å¹¶ç‚¹å‡»"åˆ†æè·¯å¾„å»ºè®®"æŒ‰é’®
                </p>
            </div>
        </div>
        
        <div class="demo-section" id="extractionSection" style="display: none;">
            <h2>ğŸ“¤ æå–ç»“æœ</h2>
            <div>
                <strong>å½“å‰è·¯å¾„ï¼š</strong> <span id="currentPath" class="suggestion-path"></span>
            </div>
            <div id="extractedValue"></div>
        </div>
    </div>

    <script type="module">
        // å¯¼å…¥JsonProcessorï¼ˆéœ€è¦ç¡®ä¿è·¯å¾„æ­£ç¡®ï¼‰
        import { JsonProcessor } from '../src/utils/jsonProcessor.js'
        
        // é¢„è®¾æ•°æ®
        const presets = {
            complex: {
                "user": {
                    "id": 123,
                    "profile": {
                        "name": "å¼ ä¸‰",
                        "age": 30,
                        "contact": {
                            "email": "zhangsan@example.com",
                            "phone": {
                                "mobile": "13800138000",
                                "home": "010-12345678"
                            }
                        },
                        "preferences": {
                            "theme": "dark",
                            "language": "zh-CN",
                            "notifications": {
                                "email": true,
                                "sms": false,
                                "push": {
                                    "enabled": true,
                                    "frequency": "daily"
                                }
                            }
                        }
                    },
                    "orders": [
                        {
                            "id": "ORD001",
                            "items": [
                                {"name": "å•†å“A", "price": 100, "quantity": 2},
                                {"name": "å•†å“B", "price": 200, "quantity": 1}
                            ],
                            "shipping": {
                                "address": "åŒ—äº¬å¸‚æœé˜³åŒºxxx",
                                "method": "express"
                            }
                        }
                    ]
                },
                "settings": {
                    "app": {
                        "version": "2.1.0",
                        "features": ["feature1", "feature2", "feature3"]
                    }
                }
            },
            
            array: [
                {
                    "category": "ç”µå­äº§å“",
                    "products": [
                        {
                            "name": "æ‰‹æœº",
                            "models": [
                                {
                                    "brand": "è‹¹æœ",
                                    "specifications": {
                                        "screen": "6.1è‹±å¯¸",
                                        "storage": ["128GB", "256GB", "512GB"],
                                        "features": {
                                            "camera": {"main": "12MP", "ultra_wide": "12MP"},
                                            "connectivity": ["5G", "WiFi6", "è“ç‰™5.0"]
                                        }
                                    }
                                }
                            ]
                        }
                    ]
                }
            ],
            
            mixed: {
                "company": {
                    "name": "ç§‘æŠ€å…¬å¸",
                    "departments": [
                        {
                            "name": "ç ”å‘éƒ¨",
                            "employees": [
                                {
                                    "id": 1001,
                                    "name": "æå››",
                                    "skills": ["JavaScript", "Python", "Go"],
                                    "projects": [
                                        {
                                            "id": "P001",
                                            "name": "é¡¹ç›®A",
                                            "status": "è¿›è¡Œä¸­",
                                            "timeline": {
                                                "start": "2024-01-01",
                                                "end": "2024-06-30",
                                                "milestones": [
                                                    {"date": "2024-03-01", "task": "éœ€æ±‚åˆ†æå®Œæˆ"},
                                                    {"date": "2024-05-01", "task": "å¼€å‘å®Œæˆ"}
                                                ]
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            },
            
            ecommerce: {
                "store": {
                    "id": "STORE001",
                    "name": "åœ¨çº¿å•†åŸ",
                    "products": [
                        {
                            "id": "PROD001",
                            "name": "æ™ºèƒ½æ‰‹æœº",
                            "category": {
                                "main": "ç”µå­äº§å“",
                                "sub": "é€šè®¯è®¾å¤‡"
                            },
                            "variants": [
                                {
                                    "sku": "SKU001",
                                    "color": "é»‘è‰²",
                                    "storage": "128GB",
                                    "price": {
                                        "original": 5999,
                                        "current": 5499,
                                        "currency": "CNY"
                                    },
                                    "inventory": {
                                        "stock": 100,
                                        "reserved": 5,
                                        "available": 95
                                    }
                                }
                            ],
                            "reviews": [
                                {
                                    "user": "ç”¨æˆ·A",
                                    "rating": 5,
                                    "comment": "å¾ˆå¥½ç”¨çš„æ‰‹æœº",
                                    "date": "2024-01-15",
                                    "helpful": {
                                        "yes": 10,
                                        "no": 1
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        }
        
        let currentJsonData = null
        let currentSuggestions = []
        
        // å…¨å±€å‡½æ•°å®šä¹‰
        window.loadPreset = function(type) {
            const data = presets[type]
            document.getElementById('jsonInput').value = JSON.stringify(data, null, 2)
        }
        
        window.analyzeJson = function() {
            const input = document.getElementById('jsonInput').value.trim()
            const maxDepth = parseInt(document.getElementById('maxDepth').value) || 4
            
            if (!input) {
                alert('è¯·è¾“å…¥JSONæ•°æ®')
                return
            }
            
            try {
                currentJsonData = input
                const parsed = JSON.parse(input)
                
                let suggestions
                if (Array.isArray(parsed)) {
                    suggestions = JsonProcessor.getArrayPathSuggestions(input, maxDepth)
                } else {
                    suggestions = JsonProcessor.getObjectPathSuggestions(input, maxDepth)
                }
                
                currentSuggestions = suggestions
                renderSuggestions(suggestions)
                updateStats(suggestions, parsed)
                
            } catch (error) {
                showError('JSONæ ¼å¼é”™è¯¯: ' + error.message)
            }
        }
        
        window.clearAll = function() {
            document.getElementById('jsonInput').value = ''
            document.getElementById('suggestionsContainer').innerHTML = '<p style="color: #7f8c8d; text-align: center; margin: 50px 0;">è¯·è¾“å…¥JSONæ•°æ®å¹¶ç‚¹å‡»"åˆ†æè·¯å¾„å»ºè®®"æŒ‰é’®</p>'
            document.getElementById('stats').style.display = 'none'
            document.getElementById('extractionSection').style.display = 'none'
        }
        
        function renderSuggestions(suggestions) {
            const container = document.getElementById('suggestionsContainer')
            
            if (suggestions.length === 0) {
                container.innerHTML = '<p style="color: #7f8c8d; text-align: center; margin: 50px 0;">æ²¡æœ‰æ‰¾åˆ°å¯ç”¨çš„è·¯å¾„å»ºè®®</p>'
                return
            }
            
            container.innerHTML = suggestions.map((suggestion, index) => `
                <div class="suggestion-item" onclick="selectSuggestion(${index})">
                    <div class="suggestion-label">${suggestion.label}</div>
                    <div class="suggestion-path">${suggestion.path || '(æ ¹è·¯å¾„)'}</div>
                    <div class="suggestion-description">${suggestion.description}</div>
                    <div class="suggestion-meta">
                        <span class="depth-badge">æ·±åº¦ ${suggestion.depth}</span>
                        <span class="type-badge type-${suggestion.type}">${getTypeLabel(suggestion.type)}</span>
                    </div>
                </div>
            `).join('')
        }
        
        window.selectSuggestion = function(index) {
            // æ¸…é™¤ä¹‹å‰çš„é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.suggestion-item').forEach(item => {
                item.classList.remove('selected')
            })
            
            // æ ‡è®°å½“å‰é€‰ä¸­
            document.querySelectorAll('.suggestion-item')[index].classList.add('selected')
            
            const suggestion = currentSuggestions[index]
            extractPath(suggestion.path)
        }
        
        function extractPath(path) {
            if (!currentJsonData) return
            
            try {
                let result
                if (!path || path === '$') {
                    result = JSON.parse(currentJsonData)
                } else {
                    result = JsonProcessor.extractJsonData(currentJsonData, path)
                }
                
                document.getElementById('currentPath').textContent = path || '$'
                document.getElementById('extractedValue').innerHTML = `<div class="extracted-value">${JSON.stringify(result, null, 2)}</div>`
                document.getElementById('extractionSection').style.display = 'block'
                
            } catch (error) {
                document.getElementById('extractedValue').innerHTML = `<div class="error">æå–å¤±è´¥: ${error.message}</div>`
                document.getElementById('extractionSection').style.display = 'block'
            }
        }
        
        function updateStats(suggestions, data) {
            const stats = document.getElementById('stats')
            const typeCount = suggestions.reduce((acc, s) => {
                acc[s.type] = (acc[s.type] || 0) + 1
                return acc
            }, {})
            
            const maxDepth = Math.max(...suggestions.map(s => s.depth))
            
            stats.innerHTML = `
                <div class="stat-item">
                    <span class="stat-number">${suggestions.length}</span>
                    <span>æ€»å»ºè®®æ•°</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">${maxDepth}</span>
                    <span>æœ€å¤§æ·±åº¦</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">${typeCount.object || 0}</span>
                    <span>å¯¹è±¡å­—æ®µ</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">${typeCount.array || 0}</span>
                    <span>æ•°ç»„å­—æ®µ</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">${typeCount.primitive || 0}</span>
                    <span>åŸºæœ¬å­—æ®µ</span>
                </div>
            `
            stats.style.display = 'flex'
        }
        
        function getTypeLabel(type) {
            const labels = {
                'object': 'å¯¹è±¡',
                'array': 'æ•°ç»„', 
                'primitive': 'åŸºæœ¬ç±»å‹'
            }
            return labels[type] || type
        }
        
        function showError(message) {
            document.getElementById('suggestionsContainer').innerHTML = `<div class="error">${message}</div>`
        }
        
        // é¡µé¢åŠ è½½å®ŒæˆååŠ è½½é»˜è®¤æ•°æ®
        window.addEventListener('load', () => {
            loadPreset('complex')
            analyzeJson()
        })
    </script>
</body>
</html>