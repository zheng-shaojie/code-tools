# 对象嵌套数组数据提取指南

## 📋 概述

系统已经完全支持复杂的嵌套数据结构，包括：
- 对象中包含数组
- 数组中包含对象
- 多层嵌套的复合结构
- 混合类型的数据提取

## 🎯 支持的数据结构类型

### 1. 对象包含数组 (Object → Array)
```json
{
  "user": {
    "name": "张三",
    "tags": ["前端", "Vue", "JavaScript"],
    "projects": [
      {"name": "项目A", "status": "进行中"},
      {"name": "项目B", "status": "已完成"}
    ]
  }
}
```

### 2. 数组包含对象 (Array → Object)
```json
[
  {
    "name": "张三",
    "profile": {
      "age": 25,
      "skills": ["Vue", "React"]
    }
  },
  {
    "name": "李四", 
    "profile": {
      "age": 30,
      "skills": ["Angular", "Node.js"]
    }
  }
]
```

### 3. 复杂嵌套结构
```json
[
  {
    "department": "技术部",
    "members": [
      {
        "name": "张三",
        "projects": [
          {"title": "系统优化", "priority": "高"},
          {"title": "新功能开发", "priority": "中"}
        ]
      }
    ]
  }
]
```

## 🛠️ 处理策略

### 策略1：数据类型自动识别

当选择源列时，系统会自动识别数据类型：
- **数组类型** → 显示数组处理配置
- **对象类型** → 显示JSON路径配置

### 策略2：智能路径建议

系统提供三种建议方式：
1. **树形建议** - 可视化展示嵌套结构
2. **路径列表** - 扁平化显示所有可用路径
3. **自动补全** - 输入时智能提示

## 📖 实际案例演示

### 案例1：从对象中提取嵌套数组的字符串

**源数据：**
```json
{
  "user": {
    "name": "张三",
    "skills": ["Vue", "React", "Node.js"],
    "projects": [
      {"name": "项目A", "tech": "Vue"},
      {"name": "项目B", "tech": "React"}
    ]
  }
}
```

**提取技能列表：**
- **数据类型：** 对象
- **JSON路径：** `$.user.skills`
- **结果：** `["Vue", "React", "Node.js"]` 或 `Vue, React, Node.js`

**提取项目名称：**
- **数据类型：** 对象  
- **JSON路径：** `$.user.projects`
- **后续处理：** 如果需要提取项目名称字符串，需要额外的处理步骤

### 案例2：从数组中提取对象的嵌套属性

**源数据：**
```json
[
  {
    "employee": {
      "name": "张三",
      "contact": {
        "email": "zhang@example.com",
        "phone": "13800138000"
      }
    }
  },
  {
    "employee": {
      "name": "李四",
      "contact": {
        "email": "li@example.com", 
        "phone": "13900139000"
      }
    }
  }
]
```

**配置方法：**
- **数据类型：** 数组
- **提取类型：** 🔗 数组转字符串
- **数组元素路径：** `employee.contact.email`
- **分隔符：** `, `
- **结果：** `zhang@example.com, li@example.com`

### 案例3：复杂多层嵌套

**源数据：**
```json
[
  {
    "department": "技术部",
    "teams": [
      {
        "name": "前端组",
        "members": [
          {"name": "张三", "role": "高级"},
          {"name": "李四", "role": "中级"}
        ]
      },
      {
        "name": "后端组", 
        "members": [
          {"name": "王五", "role": "高级"},
          {"name": "赵六", "role": "初级"}
        ]
      }
    ]
  }
]
```

**可能的提取配置：**

1. **提取部门名称：**
   - 数组元素路径：`department`
   - 结果：`技术部`

2. **提取所有团队名称：**
   - 数组元素路径：`teams[0].name` (仅第一个团队)
   - 或需要多个规则分别提取

3. **提取特定成员信息：**
   - 数组元素路径：`teams[0].members[0].name`
   - 结果：`张三`

## 🔧 高级处理技巧

### 技巧1：多步骤提取

对于复杂嵌套，可能需要多个提取规则：

```json
// 源数据
[
  {
    "project": {
      "name": "系统升级",
      "participants": [
        {"name": "张三", "role": "开发"},
        {"name": "李四", "role": "测试"}
      ]
    }
  }
]
```

**提取步骤：**
1. **规则1：** 提取项目名称
   - 路径：`project.name`
   
2. **规则2：** 提取参与者名称
   - 路径：`project.participants[0].name` (第一个参与者)
   
3. **规则3：** 提取参与者角色
   - 路径：`project.participants[0].role`

### 技巧2：使用树形建议

1. 选择包含复杂JSON的列
2. 点击"💡 建议"按钮
3. 在树形结构中浏览所有可用路径
4. 点击目标节点自动填入路径

### 技巧3：路径语法

系统支持标准JSONPath语法：
- `$.user.name` - 对象属性
- `$.users[0]` - 数组第一个元素
- `$.users[0].name` - 数组元素的属性
- `$.department.teams[0].members[0].name` - 深层嵌套

## ⚠️ 注意事项

### 1. 数据类型识别
- 系统会自动识别根级数据类型
- 对象类型使用JSON路径配置
- 数组类型使用数组处理配置

### 2. 深度限制
- 树形建议默认深度为4层
- 超过限制的层级需要手动输入路径

### 3. 性能考虑
- 复杂嵌套结构可能影响性能
- 建议针对具体需求配置提取规则

### 4. 数组索引
- 使用 `[0]`, `[1]` 等指定数组索引
- `[0]` 表示提取第一个元素的属性
- 空路径表示提取整个数组

## 🎉 最佳实践

1. **先查看数据结构** - 使用JSON预览了解数据格式
2. **使用树形建议** - 可视化浏览所有可用路径
3. **逐步提取** - 复杂结构分步骤提取
4. **验证结果** - 使用预览功能确认提取效果
5. **合理命名** - 给新列起有意义的名称

## 📚 总结

系统已经完全支持对象嵌套数组的各种复杂情况，通过智能的数据类型识别、可视化的路径建议和灵活的提取配置，可以处理几乎所有的JSON数据结构。关键是理解数据类型和正确配置提取路径。