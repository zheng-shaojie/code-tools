# SQL 工具集 - uTools 插件

一个强大的 uTools 插件，提供多种 SQL 相关的实用工具。

## 🚀 功能特点

### 1. SQL IN 条件生成器
✨ **多种输入方式支持**
- 多行文本（每行一个值）
- 分隔符文本（逗号、分号、竖线、空格等）
- 自定义分隔符

🎯 **智能文本处理**
- 自动去除首尾空格
- 自动移除空行
- 自动去重
- 智能引号处理

### 2. Excel 转 SQL 生成器
📊 **Excel 文件支持**
- 支持 .xlsx 和 .xls 格式
- 拖拽上传或点击选择
- 多工作表选择
- 实时数据预览

🔧 **灵活的SQL生成**
- INSERT 语句生成
- UPDATE 语句生成（支持WHERE条件）
- 自定义表名和字段映射
- 智能数据类型识别

🎛️ **高级配置选项**
- 列映射配置（Excel列对应数据库字段）
- 批量启用/禁用列
- 自动字段名生成建议
- WHERE条件字段配置（UPDATE模式）

## 安装方法

### 方法一：通过 uTools 插件市场安装（推荐）
1. 打开 uTools
2. 搜索 "SQL IN 条件生成器"
3. 点击安装

### 方法二：手动安装
1. 下载本项目的所有文件
2. 打开 uTools 设置
3. 进入"插件"选项卡
4. 点击"开发者 -> 安装本地插件"
5. 选择包含 `plugin.json` 的项目文件夹

## 使用方法

### 启动插件
在 uTools 中输入以下任一关键词：

**SQL IN 条件生成器**：
- `sql`
- `in`
- `条件`
- `生成`
- `查询`
- `SQL IN`
- `in条件`

**Excel 转 SQL 生成器**：
- `excel`
- `insert`
- `update`
- `导入`
- `Excel转SQL`
- `数据导入`

### 输入文本示例

#### 1. 多行文本输入
```
user001
user002
user003
admin
guest
```

#### 2. 逗号分隔
```
apple,banana,orange,grape,watermelon
```

#### 3. 分号分隔
```
北京;上海;广州;深圳;杭州
```

#### 4. 竖线分隔
```
100001|100002|100003|100004
```

#### 5. 空格分隔
```
1 2 3 4 5 6 7 8 9 10
```

### Excel 转 SQL 使用步骤

#### 1. 选择Excel文件
- 点击文件选择区域或直接拖拽 Excel 文件
- 支持 `.xlsx` 和 `.xls` 格式

#### 2. 选择工作表
- 从下拉列表中选择要处理的工作表
- 查看数据预览（显示前10行）

#### 3. 配置 SQL 参数
- **SQL类型**：选择 INSERT 或 UPDATE
- **表名**：输入目标数据库表名
- **WHERE条件字段**（UPDATE模式）：指定更新条件字段

#### 4. 配置列映射
- 为每个 Excel 列设置对应的数据库字段名
- 可以选择性启用/禁用某些列
- 系统会自动生成字段名建议

#### 5. 生成 SQL
- 点击“生成 SQL”按钮
- 查看生成的 SQL 语句
- 一键复制所有语句

### 配置选项

- **分隔符选择**：支持换行符、逗号、分号、竖线、空格或自定义分隔符
- **添加单引号**：为每个值自动添加单引号（适用于字符串类型）
- **去除首尾空格**：自动清理每个值的前后空格
- **移除空行**：自动过滤掉空的行或值
- **字段名**：自定义 SQL 查询中的字段名

### 输出结果

插件会生成两种格式的 SQL：

1. **完整查询示例**
```sql
-- 完整查询示例
SELECT * FROM your_table 
WHERE id IN ('user001', 'user002', 'user003', 'admin', 'guest');

-- 仅条件部分
id IN ('user001', 'user002', 'user003', 'admin', 'guest')
```

2. **仅条件部分**（用于复杂查询的组合）

## 使用场景

🎯 **数据库查询**
- 快速生成用户ID的查询条件
- 批量查询特定商品
- 筛选指定地区的数据

💼 **开发调试**
- 测试数据准备
- 快速构建查询语句
- 数据分析和统计

📊 **数据处理**
- Excel 数据转换
- 日志分析
- 批量数据操作

## 快捷操作

- **Ctrl/Cmd + Enter**：快速生成 SQL
- **点击复制按钮**：将结果复制到剪贴板
- **实时预览**：输入时自动生成结果

## 技术特性

- 🔒 **本地处理**：所有数据在本地处理，保护隐私
- ⚡ **实时响应**：输入即时生成结果
- 🎨 **美观界面**：现代化的用户界面设计
- 📱 **响应式设计**：适配不同尺寸的窗口

## 文件结构

```
sql-toolkit/
├── plugin.json      # 插件配置文件
├── index.html       # SQL IN 条件生成器页面
├── excel.html       # Excel 转 SQL 生成器页面
├── style.css        # 通用样式文件
├── main.js          # SQL IN 条件生成器逻辑
├── excel.js         # Excel 转 SQL 生成器逻辑
├── preload.js       # uTools 预加载脚本
└── README.md        # 说明文档
```

## 开发说明

### 本地开发
1. 克隆项目到本地
2. 在项目目录启动 HTTP 服务器：
   ```bash
   python3 -m http.server 8000
   ```
3. 浏览器访问 `http://localhost:8000`

### 插件开发
- 基于 uTools 插件开发规范
- 使用原生 JavaScript，无外部依赖
- 支持 uTools API 集成

## 更新日志

### v2.0.0 (2024-08-25)
- 🎉 新增 Excel 转 SQL 功能
- ✨ 支持 INSERT 和 UPDATE 语句生成
- 🔧 智能列映射配置
- 📊 Excel 文件拖拽上传
- 🎛️ 可视化数据预览
- 📦 新增导航标签页设计

### v1.0.0 (2024-08-25)
- 🎉 初始版本发布
- ✅ 支持多种分隔符
- ✅ 实时预览功能
- ✅ 一键复制功能
- ✅ 响应式设计
- ✅ 智能引号转义处理

## 贡献

欢迎提交 Issue 和 Pull Request！

## 许可证

MIT License

## 联系方式

如有问题或建议，请通过 uTools 插件评论区反馈。

---

💡 **提示**：这个插件特别适合需要频繁编写 SQL 查询的开发者、数据分析师和数据库管理员使用。